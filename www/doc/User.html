<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: User
  
    &mdash; Documentation by YARD 0.8.7.6
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '';
  framesUrl = "frames.html#!User.html";
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="_index.html">Index (U)</a> &raquo;
    
    
    <span class="title">User</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: User
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="ActiveRecord/Base.html" title="ActiveRecord::Base (class)">ActiveRecord::Base</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="ActiveRecord/Base.html" title="ActiveRecord::Base (class)">ActiveRecord::Base</a></span></li>
          
            <li class="next">User</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2">Agis</dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">app/models/user.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="User/NoSteamID.html" title="User::NoSteamID (class)">NoSteamID</a></span>
    
  
</p>







  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#agis_id-instance_method" title="#agis_id (instance method)">- (Object) <strong>agis_id</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#areserve_room-instance_method" title="#areserve_room (instance method)">- (Object) <strong>areserve_room</strong>(room_id, ruleset) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#balance_realized-instance_method" title="#balance_realized (instance method)">- (Object) <strong>balance_realized</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Total balance for realized funds.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#balance_realized%3D-instance_method" title="#balance_realized= (instance method)">- (Object) <strong>balance_realized=</strong>(v) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Change the total realized balance in Redis.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#balance_unrealized-instance_method" title="#balance_unrealized (instance method)">- (Object) <strong>balance_unrealized</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Total balance exclusively of unrealized funds.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#balance_unrealized%3D-instance_method" title="#balance_unrealized= (instance method)">- (Object) <strong>balance_unrealized=</strong>(v) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Change the total unrealized balance in Redis.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fetch_steamapi-instance_method" title="#fetch_steamapi (instance method)">- (Object) <strong>fetch_steamapi</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Load up steam_name and steam_avatar_urls for the User.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_reservation-instance_method" title="#get_reservation (instance method)">- (Object) <strong>get_reservation</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns an ActiveRecord instance of Room, only if the current reservation
is a Room.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hrapidkey-instance_method" title="#hrapidkey (instance method)">- (Object) <strong>hrapidkey</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#is_reserved%3F-instance_method" title="#is_reserved? (instance method)">- (Boolean) <strong>is_reserved?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Whether or not the User is currently reserved at all.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_balance-instance_method" title="#load_balance (instance method)">- (Object) <strong>load_balance</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Ask ActiveRecord for the user&#39;s most recent transaction balance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#name-instance_method" title="#name (instance method)">- (Object) <strong>name</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Either the name of the user&#39;s Steam account or the first four
characters of their email address.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#rapidkey-instance_method" title="#rapidkey (instance method)">- (Object) <strong>rapidkey</strong>(s) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reservation-instance_method" title="#reservation (instance method)">- (Object) <strong>reservation</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Array containing 1) the Transaction::KIND_ enum for the current reserver 2)
the ID for the row in the current reserver&#39;s table.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reservation_is_room%3F-instance_method" title="#reservation_is_room? (instance method)">- (Boolean) <strong>reservation_is_room?</strong>(room_id) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Check if the reservation is a given Room.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reservation_lives%3F-instance_method" title="#reservation_lives? (instance method)">- (Boolean) <strong>reservation_lives?</strong>(res) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Check if the Room associated with the User is alive.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reserve%21-instance_method" title="#reserve! (instance method)">- (Object) <strong>reserve!</strong>(kind, id) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Reserve the User with an associated row in some table.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reserve_room%21-instance_method" title="#reserve_room! (instance method)">- (Boolean) <strong>reserve_room!</strong>(room_id, ruleset) </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Reserve a new room if the User is not already reserved and is valid for
reservation.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#steam_avatar_urls-instance_method" title="#steam_avatar_urls (instance method)">- (Object) <strong>steam_avatar_urls</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Three avatar URLs for the given user, increasing in size, separated by
spaces.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#steam_name-instance_method" title="#steam_name (instance method)">- (Object) <strong>steam_name</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Steam name of the current user.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#total_balance-instance_method" title="#total_balance (instance method)">- (Object) <strong>total_balance</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Total balance of unrealized + realized funds.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unreserve%21-instance_method" title="#unreserve! (instance method)">- (Object) <strong>unreserve!</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Forcefully and blindly destroy the User&#39;s reservation.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="ActiveRecord/Base.html" title="ActiveRecord::Base (class)">ActiveRecord::Base</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="ActiveRecord/Base.html#reset_subclasses-class_method" title="ActiveRecord::Base.reset_subclasses (method)">reset_subclasses</a></span></p>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="agis_id-instance_method">
  
    - (<tt>Object</tt>) <strong>agis_id</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


48
49
50</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 48</span>

<span class='kw'>def</span> <span class='id identifier rubyid_agis_id'>agis_id</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="areserve_room-instance_method">
  
    - (<tt>Object</tt>) <strong>areserve_room</strong>(room_id, ruleset) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


136
137
138
139
140
141
142
143
144
145
146</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 136</span>

<span class='kw'>def</span> <span class='id identifier rubyid_areserve_room'>areserve_room</span> <span class='lparen'>(</span><span class='id identifier rubyid_room_id'>room_id</span><span class='comma'>,</span> <span class='id identifier rubyid_ruleset'>ruleset</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reservation'>reservation</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_is_reserved?'>is_reserved?</span> <span class='kw'>and</span> <span class='kw'>not</span> <span class='id identifier rubyid_reservation_is_room?'>reservation_is_room?</span><span class='lparen'>(</span><span class='id identifier rubyid_room_id'>room_id</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='id identifier rubyid_reservation_lives?'>reservation_lives?</span><span class='lparen'>(</span><span class='id identifier rubyid_res'>res</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_reservation_is_room?'>reservation_is_room?</span><span class='lparen'>(</span><span class='id identifier rubyid_room_id'>room_id</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_vself'>vself</span> <span class='op'>=</span> <span class='const'>User</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span> <span class='comment'># load the data from the database
</span>    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='kw'>not</span> <span class='id identifier rubyid_vself'>vself</span><span class='period'>.</span><span class='id identifier rubyid_is_reserved?'>is_reserved?</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id identifier rubyid_vself'>vself</span><span class='period'>.</span><span class='id identifier rubyid_steamid'>steamid</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>unless</span> <span class='id identifier rubyid_vself'>vself</span><span class='period'>.</span><span class='id identifier rubyid_total_balance'>total_balance</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_ruleset'>ruleset</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>wager</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
  <span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hset'>hset</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>reservation</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='const'>Transaction</span><span class='op'>::</span><span class='const'>KIND_ROOM</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_room_id'>room_id</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
  <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="balance_realized-instance_method">
  
    - (<tt>Object</tt>) <strong>balance_realized</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Total balance for realized funds</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


92
93
94
95
96
97</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 92</span>

<span class='kw'>def</span> <span class='id identifier rubyid_balance_realized'>balance_realized</span>
  <span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hfetch'>hfetch</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>balance_realized</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
    <span class='id identifier rubyid_load_balance'>load_balance</span>
    <span class='ivar'>@realized</span>
  <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="balance_realized=-instance_method">
  
    - (<tt>Object</tt>) <strong>balance_realized=</strong>(v) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Change the total realized balance in Redis</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


100
101
102</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 100</span>

<span class='kw'>def</span> <span class='id identifier rubyid_balance_realized='>balance_realized=</span> <span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span>
  <span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hset'>hset</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>balance_realized</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="balance_unrealized-instance_method">
  
    - (<tt>Object</tt>) <strong>balance_unrealized</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Total balance exclusively of unrealized funds</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


79
80
81
82
83
84</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 79</span>

<span class='kw'>def</span> <span class='id identifier rubyid_balance_unrealized'>balance_unrealized</span>
  <span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hfetch'>hfetch</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>balance_unrealized</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
    <span class='id identifier rubyid_load_balance'>load_balance</span>
    <span class='ivar'>@unrealized</span>
  <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="balance_unrealized=-instance_method">
  
    - (<tt>Object</tt>) <strong>balance_unrealized=</strong>(v) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Change the total unrealized balance in Redis</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


87
88
89</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 87</span>

<span class='kw'>def</span> <span class='id identifier rubyid_balance_unrealized='>balance_unrealized=</span> <span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span>
  <span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hset'>hset</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>balance_unrealized</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fetch_steamapi-instance_method">
  
    - (<tt>Object</tt>) <strong>fetch_steamapi</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Load up steam_name and steam_avatar_urls for the User. They themselves call
this implicitly</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


186
187
188
189
190
191
192
193
194
195
196
197</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 186</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fetch_steamapi'>fetch_steamapi</span>
  <span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hfetch'>hfetch</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>steamapi</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>do</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>NoSteamID</span> <span class='kw'>unless</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_steamid'>steamid</span>
    <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>open-uri</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_steamapik'>steamapik</span> <span class='op'>=</span> <span class='gvar'>$GAMERIST_API_KEYS</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>steam</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http://api.steampowered.com/ISteamUser/GetPlayerSummaries/v0002/?key=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_steamapik'>steamapik</span><span class='rbrace'>}</span><span class='tstring_content'>&amp;steamids=</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_steamid'>steamid</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_player'>player</span> <span class='op'>=</span> <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>response</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>players</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
    <span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hset'>hset</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>avatar_urls</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_player'>player</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>avatar</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_player'>player</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>avatarmedium</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_player'>player</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>avatarfull</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hset'>hset</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>steamname</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_player'>player</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>personaname</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_reservation-instance_method">
  
    - (<tt>Object</tt>) <strong>get_reservation</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns an ActiveRecord instance of Room, only if the current reservation
is a Room</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


175
176
177
178
179
180
181
182
183</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 175</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_reservation'>get_reservation</span>
  <span class='id identifier rubyid_reserve'>reserve</span> <span class='op'>=</span> <span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hget'>hget</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>reservation</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>if</span> <span class='id identifier rubyid_reserve'>reserve</span>
    <span class='id identifier rubyid_resp'>resp</span> <span class='op'>=</span> <span class='id identifier rubyid_reserve'>reserve</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>if</span><span class='lparen'>(</span><span class='id identifier rubyid_resp'>resp</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>==</span> <span class='const'>Transaction</span><span class='op'>::</span><span class='const'>KIND_ROOM</span><span class='rparen'>)</span>
      <span class='kw'>return</span> <span class='const'>Room</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_resp'>resp</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="hrapidkey-instance_method">
  
    - (<tt>Object</tt>) <strong>hrapidkey</strong> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


63
64
65</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 63</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gamerist-user {}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="is_reserved?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>is_reserved?</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Whether or not the User is currently reserved at all</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


163
164
165</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 163</span>

<span class='kw'>def</span> <span class='id identifier rubyid_is_reserved?'>is_reserved?</span>
  <span class='lparen'>(</span><span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hget'>hget</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>reservation</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>!=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_balance-instance_method">
  
    - (<tt>Object</tt>) <strong>load_balance</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Ask ActiveRecord for the user&#39;s most recent transaction balance. Loads
up both realized and unrealized</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


70
71
72
73
74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 70</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_balance'>load_balance</span>
  <span class='id identifier rubyid_l'>l</span> <span class='op'>=</span> <span class='const'>Transaction</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>user_id:</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='ivar'>@unrealized</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_l'>l</span> <span class='op'>!=</span> <span class='kw'>nil</span> <span class='op'>?</span> <span class='id identifier rubyid_l'>l</span><span class='period'>.</span><span class='id identifier rubyid_balance_u'>balance_u</span> <span class='op'>:</span> <span class='int'>0</span><span class='rparen'>)</span>
  <span class='ivar'>@realized</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_l'>l</span> <span class='op'>!=</span> <span class='kw'>nil</span> <span class='op'>?</span> <span class='id identifier rubyid_l'>l</span><span class='period'>.</span><span class='id identifier rubyid_balance_r'>balance_r</span> <span class='op'>:</span> <span class='int'>0</span><span class='rparen'>)</span>
  <span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hset'>hset</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>balance_unrealized</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='ivar'>@unrealized</span>
  <span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hset'>hset</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>balance_realized</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='ivar'>@realized</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="name-instance_method">
  
    - (<tt>Object</tt>) <strong>name</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Either the name of the user&#39;s Steam account or the first four
characters of their email address</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 55</span>

<span class='kw'>def</span> <span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_steam_name'>steam_name</span> <span class='kw'>or</span> <span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='int'>3</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>...</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="rapidkey-instance_method">
  
    - (<tt>Object</tt>) <strong>rapidkey</strong>(s) 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 59</span>

<span class='kw'>def</span> <span class='id identifier rubyid_rapidkey'>rapidkey</span><span class='lparen'>(</span><span class='id identifier rubyid_s'>s</span><span class='rparen'>)</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>gamerist-user {</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_s'>s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reservation-instance_method">
  
    - (<tt>Object</tt>) <strong>reservation</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Array containing 1) the Transaction::KIND_ enum for the current reserver 2)
the ID for the row in the current reserver&#39;s table</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


169
170
171
172</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 169</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reservation'>reservation</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>unless</span> <span class='id identifier rubyid_reserve'>reserve</span> <span class='op'>=</span> <span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hget'>hget</span><span class='lparen'>(</span><span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>reservation</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_reserve'>reserve</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reservation_is_room?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>reservation_is_room?</strong>(room_id) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Check if the reservation is a given Room</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>room_id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>ID for the given Room</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Whether or not the User is reserved right now by this Room</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


131
132
133
134</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 131</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reservation_is_room?'>reservation_is_room?</span> <span class='lparen'>(</span><span class='id identifier rubyid_room_id'>room_id</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_res'>res</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reservation'>reservation</span>
  <span class='lparen'>(</span><span class='id identifier rubyid_res'>res</span> <span class='kw'>and</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>==</span> <span class='const'>Transaction</span><span class='op'>::</span><span class='const'>KIND_ROOM</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='kw'>and</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>==</span> <span class='id identifier rubyid_room_id'>room_id</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reservation_lives?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>reservation_lives?</strong>(res) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Check if the Room associated with the User is alive. Queries the Room&#39;s
is_alive?</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>res</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The reservation provided by User#reservation</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether or not the Room is alive and data loss has not occured</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


123
124
125
126</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 123</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reservation_lives?'>reservation_lives?</span><span class='lparen'>(</span><span class='id identifier rubyid_res'>res</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_res'>res</span> <span class='kw'>and</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='op'>==</span> <span class='const'>Transaction</span><span class='op'>::</span><span class='const'>KIND_ROOM</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='kw'>and</span> <span class='const'>Room</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='label'>id:</span> <span class='id identifier rubyid_res'>res</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_is_alive?'>is_alive?</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reserve!-instance_method">
  
    - (<tt>Object</tt>) <strong>reserve!</strong>(kind, id) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Reserve the User with an associated row in some table.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>kind</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Transaction::KIND_ enum for this reserver</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>ID for the row in this reserver type&#39;s table</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


115
116
117</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 115</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reserve!'>reserve!</span> <span class='lparen'>(</span><span class='id identifier rubyid_kind'>kind</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hset'>hset</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>reservation</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_kind'>kind</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reserve_room!-instance_method">
  
    - (<tt>Boolean</tt>) <strong>reserve_room!</strong>(room_id, ruleset) 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Reserve a new room if the User is not already reserved and is valid for
reservation</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>room_id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>ID for the given room</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ruleset</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Room#srules for this given room</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Whether or not the User is now reserved</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


153
154
155</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 153</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reserve_room!'>reserve_room!</span> <span class='lparen'>(</span><span class='id identifier rubyid_room_id'>room_id</span><span class='comma'>,</span> <span class='id identifier rubyid_ruleset'>ruleset</span><span class='rparen'>)</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_acall'>acall</span><span class='lparen'>(</span><span class='gvar'>$redis</span><span class='comma'>,</span> <span class='symbol'>:areserve_room</span><span class='comma'>,</span> <span class='id identifier rubyid_room_id'>room_id</span><span class='comma'>,</span> <span class='id identifier rubyid_ruleset'>ruleset</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="steam_avatar_urls-instance_method">
  
    - (<tt>Object</tt>) <strong>steam_avatar_urls</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Three avatar URLs for the given user, increasing in size, separated by
spaces</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


212
213
214
215
216
217
218
219
220</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 212</span>

<span class='kw'>def</span> <span class='id identifier rubyid_steam_avatar_urls'>steam_avatar_urls</span>
  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>http:// http:// http://</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_test?'>test?</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_fetch_steamapi'>fetch_steamapi</span>
    <span class='kw'>return</span> <span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hget'>hget</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>avatar_urls</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>rescue</span> <span class='const'>NoSteamID</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="steam_name-instance_method">
  
    - (<tt>Object</tt>) <strong>steam_name</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Steam name of the current user</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


200
201
202
203
204
205
206
207
208</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 200</span>

<span class='kw'>def</span> <span class='id identifier rubyid_steam_name'>steam_name</span>
  <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hello</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_test?'>test?</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_fetch_steamapi'>fetch_steamapi</span>
    <span class='kw'>return</span> <span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hget'>hget</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>steamname</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>rescue</span> <span class='const'>NoSteamID</span>
    <span class='kw'>return</span> <span class='kw'>nil</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="total_balance-instance_method">
  
    - (<tt>Object</tt>) <strong>total_balance</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Total balance of unrealized + realized funds. Realized funds can do
everything unrealized funds can do.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 107</span>

<span class='kw'>def</span> <span class='id identifier rubyid_total_balance'>total_balance</span>
  <span class='id identifier rubyid_balance_unrealized'>balance_unrealized</span> <span class='op'>+</span> <span class='id identifier rubyid_balance_realized'>balance_realized</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="unreserve!-instance_method">
  
    - (<tt>Object</tt>) <strong>unreserve!</strong> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Forcefully and blindly destroy the User&#39;s reservation</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


158
159
160</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/user.rb', line 158</span>

<span class='kw'>def</span> <span class='id identifier rubyid_unreserve!'>unreserve!</span>
  <span class='gvar'>$redis</span><span class='period'>.</span><span class='id identifier rubyid_hdel'>hdel</span> <span class='id identifier rubyid_hrapidkey'>hrapidkey</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>reservation</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Thu Jun  4 13:16:53 2015 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.6 (ruby-2.2.0).
</div>

  </body>
</html>